Sub Workbook_Open()


Dim hFile As Long
Dim path As String, fileName As String, ribbonXML As String, user As String

hFile = FreeFile
user = Environ("Username")
path = "C:\Users\" & user & "\AppData\Local\Microsoft\Office\"
fileName = "Excel.officeUI"

    ribbonXML = "<mso:customUI       xmlns:mso='http://schemas.microsoft.com/office/2009/07/customui'>" & vbNewLine
    ribbonXML = ribbonXML + "  <mso:ribbon>" & vbNewLine
    ribbonXML = ribbonXML + "    <mso:qat/>" & vbNewLine
    ribbonXML = ribbonXML + "    <mso:tabs>" & vbNewLine
    ribbonXML = ribbonXML + "      <mso:tab id='TienNLM' label='TienNLM' insertBeforeQ='mso:TabFormat'>" & vbNewLine
    
    ribbonXML = ribbonXML + "        <mso:group id='CNB' label='CNB' autoScale='true'>" & vbNewLine
    ribbonXML = ribbonXML + "          <mso:button id='Open_CNB' label='Open_CNB' " & vbNewLine
    ribbonXML = ribbonXML + "imageMso='PivotTableGenerateGetPivotData'      onAction='TienNLM.xlam!Open_CNB'/>" & vbNewLine
    ribbonXML = ribbonXML + "          <mso:button id='PIT_Monthly' label='PIT_Monthly' " & vbNewLine
    ribbonXML = ribbonXML + "imageMso='CalculationOptionsMenu'      onAction='TienNLM.xlam!PIT_Monthly'/>" & vbNewLine
    ribbonXML = ribbonXML + "          <mso:button id='Exchange_Rate' label='Exchange_Rate' " & vbNewLine
    ribbonXML = ribbonXML + "imageMso='Spelling'      onAction='TienNLM.xlam!Exchange_Rate'/>" & vbNewLine
    ribbonXML = ribbonXML + "        </mso:group>" & vbNewLine
    
    ribbonXML = ribbonXML + "        <mso:group id='SMD' label='SMD' autoScale='true'>" & vbNewLine
    ribbonXML = ribbonXML + "          <mso:button id='SMD_CTV_ATT' label='SMD_CTV_ATT' " & vbNewLine
    ribbonXML = ribbonXML + "imageMso='ReturnToTaskList'      onAction='TienNLM.xlam!SMD_CTV_ATT'/>" & vbNewLine
    ribbonXML = ribbonXML + "        </mso:group>" & vbNewLine

    ribbonXML = ribbonXML + "        <mso:group id='Payroll' label='Payroll' autoScale='true'>" & vbNewLine
    ribbonXML = ribbonXML + "          <mso:button id='ATT_Check' label='ATT_Check' " & vbNewLine
    ribbonXML = ribbonXML + "imageMso='MailMergeAutoCheckForErrors'      onAction='TienNLM.xlam!ATT_Check'/>" & vbNewLine
    ribbonXML = ribbonXML + "          <mso:button id='Unmerge_T2C' label='Unmerge_T2C' " & vbNewLine
    ribbonXML = ribbonXML + "imageMso='TableColumnsGallery'      onAction='TienNLM.xlam!Unmerge_T2C'/>" & vbNewLine
    ribbonXML = ribbonXML + "        </mso:group>" & vbNewLine
    
    ribbonXML = ribbonXML + "      </mso:tab>" & vbNewLine
    ribbonXML = ribbonXML + "    </mso:tabs>" & vbNewLine
    ribbonXML = ribbonXML + "  </mso:ribbon>" & vbNewLine
    ribbonXML = ribbonXML + "</mso:customUI>"

ribbonXML = Replace(ribbonXML, """", "")
Open path & fileName For Output Access Write As hFile
Print #hFile, ribbonXML
Close hFile

End Sub
